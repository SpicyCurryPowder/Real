<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REAL. - Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="/css/styles.css">
</head>

<body>
    <header>
        <h1 class="logo">Real
            <img src="/images/green_circle.png">
        </h1>
    </header>
    <main>
        <div class="image-tile-container">
            <!-- Image Section -->
            <img src="../<%= post.newsImgSrc %>" alt="Article Image" class="full-width-image">
        
            <!-- Blue and Red Tile with Unverified label -->
            <div class="full-width-tile">
                <h5 class="tile-heading">
                    <%= post.title %>
                </h5>
                <span class="label"><%= post.ribbonType %></span>
            </div>
        </div>

        <div class="user-info-container">
            <div class="user-profile">
                <img src="../<%= post.imgSrc %>" alt="User Profile" class="profile-pic">
            </div>
            <div class="user-details">
                <span class="user-name">John Doe</span>
                <span class="date-time">October 14, 2024 | 10:00 AM</span>
            </div>
            <a href="/source-news" class="verify-btn">
                Verify
            </a>
        </div>

        <h4 class="heading-heat">News Interaction Heatmap: <span class="secondary-text">See How Users Engage</span></h4>
        <div id="map" style="height: 60vh; margin: 2rem; z-index: -10;"></div>
        <div id="location-not-available" style="text-align:center; background-color: lightgrey; height: 60vh; margin: 2rem; display: none;">Location not available</div>



        <p class="para">
            <%= post.content %>
        </p>
        <div class="disclaimer">
            <h5>Our terms & conditions:</h5>
            <p>
                All posts will have appropriate citations to verify the content and go through first-hand AI
                verification. Posts can be turned unverified or marked as missing sources when identified and labeled as
                fake if proven false with evidence. Users who make abusive claims will be removed from the community
                after a warning.
            </p>
        </div>
    </main>


    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js"></script>
    <script src="/js/leaflet-heat.js" type="text/javascript"></script>
    <script>
        var postCoordinates = "<%= post.coordinates %>";
        var locationTitle = "<%= post.title %>";
        var latlong = postCoordinates.split(",");
        const mapElement = document.getElementById('map');
        const locationNotAvailable = document.getElementById('location-not-available');

        if (postCoordinates) {
            const map = L.map('map');
            map.setView(latlong, 23) 

            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                // maxZoom: 23,
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            var marker = L.marker(latlong)
            map.addLayer(marker);
        } else {
            mapElement.style.display = 'none';  // Hide the map
            locationNotAvailable.style.display = 'block';  // Show the fallback message
        }

        
    </script>

    <nav class="bottom-nav">
        <a href="/">
            <div class="nav-icon"><img src="/vectors/home.svg"></div>
            <span>Home</span>
        </a>
        <a href="/verified-news" class="active">
            <div class="nav-icon"><img src="/vectors/verified-icon.svg"></div>
            <span>Verified News</span>
        </a>
        <a href="/map">
            <div class="nav-icon"><img src="/vectors/map.svg"></div>
            <span>Map</span>
        </a>
    </nav>
</body>

</html>